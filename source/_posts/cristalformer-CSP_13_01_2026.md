---
title: "CrystalFormer-CSP: ‚ÄúFast Thinking‚Äù and ‚ÄúSlow Thinking‚Äù for Crystal Structure Prediction"
date: 2026-1-13
categories: 
- Other
---

Given a chemical formula, for example Cu‚ÇÅ‚ÇÇSb‚ÇÑS‚ÇÅ‚ÇÉ, how should the atoms be arranged in space in order to form a stable crystal? This is the problem of crystal structure prediction (Crystal Structure Prediction, CSP), one of the fundamental challenges in materials science research. Recently, the Institute of Physics, Chinese Academy of Sciences released CrystalFormer-CSP to the DeepModeling community, adopting a strategy that combines ‚Äúfast thinking‚Äù and ‚Äúslow thinking‚Äù to address this challenge.

<!--more-->

## Fast Thinking and Slow Thinking

The Nobel Prize‚Äìwinning economist Daniel Kahneman proposed a classic theory that human thinking is divided into two systems. System 1 (‚Äúfast thinking‚Äù) relies on intuition and experience, responds rapidly, but is prone to errors. For example, when seeing ‚Äú1 + 1‚Äù, we can almost give the answer without thinking. System 2 (‚Äúslow thinking‚Äù), by contrast, relies on logical reasoning, operates more slowly, but produces reliable results; when solving a problem in advanced mathematics, one must carefully work through each step. CrystalFormer-CSP puts this idea into practice in the task of crystal structure prediction: a generative model is used to quickly ‚Äúguess‚Äù candidate structures, and physical calculations are then used to slowly ‚Äúverify‚Äù their stability.

## System 1: Rapid Generation

CrystalFormer is a pre-trained crystal generative model that plays the role of System 1. By compressing databases of stable crystals, it learns a form of ‚Äúchemical intuition‚Äù: which space groups, Wyckoff positions, and coordination relationships are more likely to form stable crystal structures. Given a chemical formula as input, the model can rapidly generate a large number of candidate structures. Its advantage lies in its speed and broad coverage, but the generation process does not rely on concepts of energy or force at all. Just like human intuition, it is fast, but not necessarily accurate.

## System 2: Physical Verification

System 2 is responsible for energy relaxation and ranking. For each candidate structure, a machine-learning force field continuously adjusts atomic positions and lattice parameters, allowing the structure to ‚Äúslide‚Äù along the energy surface toward lower energy. Ultimately, the stability of the structure is evaluated using the convex hull energy (E_hull). This stage follows physical principles and answers the core question: from an energetic perspective, can this structure exist stably? Its advantage is physical reliability, but the cost is slower computation.

## Reinforcement Learning: Letting Slow Thinking Shape Fast Thinking

The ‚Äúfast thinking and slow thinking‚Äù of crystal structure prediction is not merely an analogy. Based on the above understanding, this work further adopts a technical framework of reinforcement fine-tuning with large language models to continuously improve the system.

As shown in the figure below: on the blue potential energy surface, the orange points represent the initial guesses rapidly generated by System 1, and the dark blue arrows indicate the relaxation process of System 2, where the structures ‚Äúslide‚Äù along the surface toward local minima (blue points). The gray dashed lines on the left represent the feedback loop of reinforcement learning: the energy information after relaxation is fed back to the generative model via policy gradient algorithms, enabling System 1 to no longer merely imitate training data, but to gradually learn to generate structures that are more physically stable.

![](https://dp-public.oss-cn-beijing.aliyuncs.com/community/Blog%20Files/CrystalFormer-CSP_13_1_2026/2.png)

The core challenge of crystal structure prediction lies in the need to find structures with sufficiently low energy while avoiding being trapped in a single configuration and missing other potentially stable phases. The reinforcement learning framework is naturally suited to this problem. By adjusting the relative weights of the energy term and the entropy term in the reward function, one can flexibly balance ‚Äúenergy minimization‚Äù and ‚Äústructural diversity‚Äù. Experimental results show that for crystals that were previously predicted unsuccessfully, reinforcement fine-tuning leads to a significant improvement in success rate.

## Why Does This Work?

Directly searching for the lowest-energy structure in atomic coordinate space means dealing with a rugged, high-dimensional potential energy surface full of local minima. One can imagine searching for the lowest point in a mountainous landscape: it is easy to get trapped in a small valley and fail to escape. Reinforcement learning changes the nature of the search. Instead of moving atoms one by one, it adjusts the ‚Äúgeneration rules‚Äù themselves. In the model parameter space, a small update can simultaneously affect multiple atoms and symmetry sites, resulting in a non-local, highly structured search. This makes the method often more efficient than direct searches in configuration space when dealing with complex crystal structures.

## Open Source and Usage

CrystalFormer-CSP is open-sourced under the Apache-2.0 license in the DeepModeling community:

[CrystalFormer-CSP](https://github.com/deepmodeling/CrystalFormer-CSP)

The project includes models trained on the Alex20s dataset, and also provides a Google Colab version as well as MCP tools that support integration with large language models. If you encounter any issues during use, feedback is welcome via GitHub Issues.

## Future Directions

The current framework focuses on stable structures at zero temperature and ambient pressure. In the future, it can be extended to finite-temperature and high-pressure conditions, moving from answering ‚Äúwhat is the most stable structure?‚Äù to ‚Äúunder what conditions does a particular structure appear?‚Äù. At present, the method is mainly applicable to inorganic crystals; future work may explore extensions to organic crystals, metal‚Äìorganic frameworks (MOFs), and disordered systems.

## Takeaways

- ‚ö° System 1: fast generation, chemical intuition, pattern matching  
- üê¢ System 2: energy calculation, physical constraints, slow but accurate  
- üîÑ Reinforcement learning: allowing slow thinking to in turn shape fast thinking


